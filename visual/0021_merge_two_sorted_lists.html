<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LC 21: Merge Two Sorted Lists - Algorithm Visualization</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="problem-info">
            <h1><span class="problem-number">#21</span> Merge Two Sorted Lists</h1>
            <p>Merge two sorted linked lists into one sorted list by splicing together their nodes.</p>
            <div class="problem-meta">
                <span class="meta-tag">üîó Linked List</span>
                <span class="meta-tag">üîÑ Two Pointers</span>
                <span class="meta-tag">‚è±Ô∏è O(n + m)</span>
                <span class="meta-tag">üíæ O(1)</span>
            </div>
            <div class="file-ref">
                üìÑ Python: <code>python/0021_merge_two_sorted_lists/0021_merge_two_sorted_lists.py</code>
            </div>
            </div>

        <div class="explanation-panel">
            <h4>üß† How It Works (Layman's Terms)</h4>
            <p>Like merging two sorted piles of cards:</p>
            <ul>
                <li><strong>Compare tops:</strong> Look at the top card of each pile</li>
                <li><strong>Take smaller:</strong> Pick the smaller one and add to merged pile</li>
                <li><strong>Repeat:</strong> Continue until one pile is empty</li>
                <li><strong>Finish:</strong> Add remaining cards from the non-empty pile</li>
            </ul>
        </div>


        <div class="visualization-section">
            <h3>üé¨ Step-by-Step Visualization</h3>
            
            <div class="controls">
                <button class="btn btn-primary" id="stepBtn" onclick="step()">Step</button>
                <button class="btn btn-success" id="autoBtn" onclick="toggleAuto()">Auto Run</button>
                <button class="btn btn-warning" onclick="reset()">Reset</button>
            </div>

            <div class="info-box secondary" style="margin-bottom: 20px;">
                üîó List1: <strong>[1, 2, 4]</strong> | List2: <strong>[1, 3, 4]</strong>
            </div>

            <div class="status-message" id="statusMessage">
                Click "Step" or "Auto Run" to start visualization
            </div>

            <div id="listsContainer" style="width: 100%; margin-top: 20px;"></div>

            <div class="explanation-panel" style="margin-top: 20px;">
                <h4>üìù Current Comparison</h4>
                <div id="comparisonDisplay" style="font-size: 1.1em; padding: 10px;">
                    Waiting to start...
                </div>
            </div>
        </div>

        <div class="code-section">
            <h3>üíª Python Solution</h3>
            <div class="code-block">
                <pre><span class="keyword">def</span> <span class="function">merge_two_lists</span>(self, list1, list2):
    dummy = ListNode(<span class="number">0</span>)
    current = dummy
    
    <span class="keyword">while</span> list1 <span class="keyword">and</span> list2:
        <span class="keyword">if</span> list1.val <= list2.val:
            current.next = list1
            list1 = list1.next
        <span class="keyword">else</span>:
            current.next = list2
            list2 = list2.next
        current = current.next
    
    current.next = list1 <span class="keyword">if</span> list1 <span class="keyword">else</span> list2
    <span class="keyword">return</span> dummy.next</pre>
            </div>
        </div>
    </div>

    <script>
        let list1 = [1, 2, 4];
        let list2 = [1, 3, 4];
        let merged = [];
        let ptr1 = 0;
        let ptr2 = 0;
        let autoInterval = null;

        function init() {
            renderLists();
        }

        function renderLists() {
            const container = document.getElementById('listsContainer');
            container.innerHTML = '';

            // Create SVG
            const width = container.offsetWidth;
            const height = 300;
            
            const svg = d3.select('#listsContainer')
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const nodeWidth = 50;
            const nodeHeight = 40;
            const spacing = 20;

            // List 1 (top)
            svg.append('text')
                .attr('x', 20)
                .attr('y', 35)
                .attr('font-weight', 'bold')
                .attr('fill', '#2196f3')
                .text('List 1:');

            list1.forEach((val, i) => {
                const x = 100 + i * (nodeWidth + spacing);
                const y = 20;
                const isActive = i === ptr1 && ptr1 < list1.length;
                const isUsed = i < ptr1;

                // Node
                svg.append('rect')
                    .attr('x', x)
                    .attr('y', y)
                    .attr('width', nodeWidth)
                    .attr('height', nodeHeight)
                    .attr('fill', isUsed ? '#e0e0e0' : (isActive ? '#2196f3' : '#fff'))
                    .attr('stroke', '#2196f3')
                    .attr('stroke-width', isActive ? 3 : 2)
                    .attr('rx', 5);

                svg.append('text')
                    .attr('x', x + nodeWidth / 2)
                    .attr('y', y + nodeHeight / 2 + 5)
                    .attr('text-anchor', 'middle')
                    .attr('font-weight', 'bold')
                    .attr('fill', isUsed ? '#999' : (isActive ? '#fff' : '#333'))
                    .text(val);

                // Arrow
                if (i < list1.length - 1) {
                    svg.append('line')
                        .attr('x1', x + nodeWidth)
                        .attr('y1', y + nodeHeight / 2)
                        .attr('x2', x + nodeWidth + spacing - 5)
                        .attr('y2', y + nodeHeight / 2)
                        .attr('stroke', '#999')
                        .attr('stroke-width', 2)
                        .attr('marker-end', 'url(#arrowhead)');
                }

                // Pointer label
                if (isActive) {
                    svg.append('text')
                        .attr('x', x + nodeWidth / 2)
                        .attr('y', y - 8)
                        .attr('text-anchor', 'middle')
                        .attr('font-size', '12px')
                        .attr('fill', '#2196f3')
                        .text('ptr1');
                }
            });

            // List 2 (middle)
            svg.append('text')
                .attr('x', 20)
                .attr('y', 115)
                .attr('font-weight', 'bold')
                .attr('fill', '#e91e63')
                .text('List 2:');

            list2.forEach((val, i) => {
                const x = 100 + i * (nodeWidth + spacing);
                const y = 100;
                const isActive = i === ptr2 && ptr2 < list2.length;
                const isUsed = i < ptr2;

                svg.append('rect')
                    .attr('x', x)
                    .attr('y', y)
                    .attr('width', nodeWidth)
                    .attr('height', nodeHeight)
                    .attr('fill', isUsed ? '#e0e0e0' : (isActive ? '#e91e63' : '#fff'))
                    .attr('stroke', '#e91e63')
                    .attr('stroke-width', isActive ? 3 : 2)
                    .attr('rx', 5);

                svg.append('text')
                    .attr('x', x + nodeWidth / 2)
                    .attr('y', y + nodeHeight / 2 + 5)
                    .attr('text-anchor', 'middle')
                    .attr('font-weight', 'bold')
                    .attr('fill', isUsed ? '#999' : (isActive ? '#fff' : '#333'))
                    .text(val);

                if (i < list2.length - 1) {
                    svg.append('line')
                        .attr('x1', x + nodeWidth)
                        .attr('y1', y + nodeHeight / 2)
                        .attr('x2', x + nodeWidth + spacing - 5)
                        .attr('y2', y + nodeHeight / 2)
                        .attr('stroke', '#999')
                        .attr('stroke-width', 2);
                }

                if (isActive) {
                    svg.append('text')
                        .attr('x', x + nodeWidth / 2)
                        .attr('y', y - 8)
                        .attr('text-anchor', 'middle')
                        .attr('font-size', '12px')
                        .attr('fill', '#e91e63')
                        .text('ptr2');
                }
            });

            // Merged list (bottom)
            svg.append('text')
                .attr('x', 20)
                .attr('y', 215)
                .attr('font-weight', 'bold')
                .attr('fill', '#4caf50')
                .text('Merged:');

            merged.forEach((val, i) => {
                const x = 100 + i * (nodeWidth + spacing);
                const y = 200;
                const isNew = i === merged.length - 1;

                svg.append('rect')
                    .attr('x', x)
                    .attr('y', y)
                    .attr('width', nodeWidth)
                    .attr('height', nodeHeight)
                    .attr('fill', isNew ? '#4caf50' : '#c8e6c9')
                    .attr('stroke', '#4caf50')
                    .attr('stroke-width', isNew ? 3 : 2)
                    .attr('rx', 5);

                svg.append('text')
                    .attr('x', x + nodeWidth / 2)
                    .attr('y', y + nodeHeight / 2 + 5)
                    .attr('text-anchor', 'middle')
                    .attr('font-weight', 'bold')
                    .attr('fill', isNew ? '#fff' : '#333')
                    .text(val);

                if (i < merged.length - 1) {
                    svg.append('line')
                        .attr('x1', x + nodeWidth)
                        .attr('y1', y + nodeHeight / 2)
                        .attr('x2', x + nodeWidth + spacing - 5)
                        .attr('y2', y + nodeHeight / 2)
                        .attr('stroke', '#4caf50')
                        .attr('stroke-width', 2);
                }
            });

            if (merged.length === 0) {
                svg.append('text')
                    .attr('x', 100)
                    .attr('y', 225)
                    .attr('fill', '#999')
                    .text('(empty)');
            }

            // Arrow marker
            svg.append('defs').append('marker')
                .attr('id', 'arrowhead')
                .attr('viewBox', '0 0 10 10')
                .attr('refX', 8)
                .attr('refY', 5)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M 0 0 L 10 5 L 0 10 Z')
                .attr('fill', '#999');
        }

        function step() {
            if (ptr1 >= list1.length && ptr2 >= list2.length) {
                document.getElementById('statusMessage').className = 'status-message success';
                document.getElementById('statusMessage').textContent = 
                    `‚úÖ Done! Merged list: [${merged.join(', ')}]`;
                document.getElementById('stepBtn').disabled = true;
                stopAuto();
                return;
            }

            let chosen;
            let source;

            if (ptr1 >= list1.length) {
                // List1 exhausted, take from list2
                chosen = list2[ptr2];
                source = 'List2';
                merged.push(chosen);
                ptr2++;
                document.getElementById('comparisonDisplay').innerHTML = 
                    `List1 exhausted ‚Üí Take <strong>${chosen}</strong> from List2`;
            } else if (ptr2 >= list2.length) {
                // List2 exhausted, take from list1
                chosen = list1[ptr1];
                source = 'List1';
                merged.push(chosen);
                ptr1++;
                document.getElementById('comparisonDisplay').innerHTML = 
                    `List2 exhausted ‚Üí Take <strong>${chosen}</strong> from List1`;
            } else {
                // Compare both
                const val1 = list1[ptr1];
                const val2 = list2[ptr2];
                
                if (val1 <= val2) {
                    chosen = val1;
                    source = 'List1';
                    merged.push(chosen);
                    ptr1++;
                } else {
                    chosen = val2;
                    source = 'List2';
                    merged.push(chosen);
                    ptr2++;
                }

                document.getElementById('comparisonDisplay').innerHTML = 
                    `Compare: ${val1} vs ${val2}<br>` +
                    `<strong>${val1 <= val2 ? val1 + ' ‚â§ ' + val2 : val1 + ' > ' + val2}</strong><br>` +
                    `Take <span style="color: ${source === 'List1' ? '#2196f3' : '#e91e63'};">${chosen}</span> from ${source}`;
            }

            document.getElementById('statusMessage').textContent = 
                `Added ${chosen} from ${source} to merged list`;

            renderLists();
        }

        function toggleAuto() {
            if (autoInterval) {
                stopAuto();
            } else {
                document.getElementById('autoBtn').textContent = 'Pause';
                autoInterval = setInterval(() => {
                    if (ptr1 >= list1.length && ptr2 >= list2.length) {
                        step();
                        stopAuto();
                    } else {
                        step();
                    }
                }, 1000);
            }
        }

        function stopAuto() {
            if (autoInterval) {
                clearInterval(autoInterval);
                autoInterval = null;
            }
            document.getElementById('autoBtn').textContent = 'Auto Run';
        }

        function reset() {
            stopAuto();
            ptr1 = 0;
            ptr2 = 0;
            merged = [];
            document.getElementById('stepBtn').disabled = false;
            document.getElementById('statusMessage').className = 'status-message';
            document.getElementById('statusMessage').textContent = 'Click "Step" or "Auto Run" to start visualization';
            document.getElementById('comparisonDisplay').textContent = 'Waiting to start...';
            init();
        }

        init();
    </script>
</body>
</html>
