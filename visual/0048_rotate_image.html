<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotate Image - LeetCode 48</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="problem-info">
            <h1><span class="problem-number">#0048</span> Rotate Image</h1>
            <p><strong>Problem:</strong> You are given an n x n 2D matrix representing an image. Rotate the image by 90 degrees clockwise in-place.</p>
            <p><strong>Pattern:</strong> Matrix Manipulation - Transpose + Reverse each row</p>
            <div class="problem-meta">
                <span class="meta-tag">üìä Array</span>
                <span class="meta-tag">‚è±Ô∏è O(n)</span>
            </div>
            <div class="file-ref">
                üìÑ Python: <code>python/0048_rotate_image/0048_rotate_image.py</code>
            </div>

        </div>

        <div class="explanation-panel">
            <h4>üß† How It Works (Layman's Terms)</h4>
            <p>Matrix problems work with <strong>2D grids</strong>:</p>
            <ul>
                <li><strong>Row/Col:</strong> Access elements by [row][col]</li>
                <li><strong>Traverse:</strong> Iterate in various patterns</li>
                <li><strong>In-place:</strong> Often modify without extra space</li>
                <li><strong>Boundaries:</strong> Watch for edge cases</li>
            </ul>
        </div>


        <div class="visualization-section">
            <h3>üé¨ Step-by-Step Visualization</h3>

            <div class="visualization">
            <svg id="mainSvg"></svg>
        </div>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
            <div class="speed-control">
                <label for="speed">Speed:</label>
                <input type="range" id="speed" min="100" max="2000" value="600">
            </div>
        </div>

        <div class="status" id="status">Click "Step" to rotate the matrix 90¬∞ clockwise</div>

        <div class="variables">
            <div class="var-item">
                <span class="var-label">Phase:</span>
                <span id="phaseDisplay">1. Transpose</span>
            </div>
            <div class="var-item">
                <span class="var-label">Current Op:</span>
                <span id="opDisplay">-</span>
            </div>
        </div>

        </div>

        <div class="code-section">
            <h3>Python Solution</h3>
            <pre><span class="keyword">def</span> <span class="function">rotate</span>(matrix):
    <span class="string">"""
    Rotate 90¬∞ clockwise = Transpose + Reverse rows
    Time: O(n¬≤), Space: O(1) in-place
    """</span>
    n = <span class="function">len</span>(matrix)
    
    <span class="comment"># Step 1: Transpose (swap [i][j] with [j][i])</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n):
        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="function">range</span>(i + <span class="number">1</span>, n):
            matrix[i][j], matrix[j][i] = matrix[j][i], matrix[i][j]
    
    <span class="comment"># Step 2: Reverse each row</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n):
        matrix[i].<span class="function">reverse</span>()</pre>
        </div>
    </div>

    <script>
        const originalMatrix = [
            [1, 2, 3],
            [4, 5, 6],
            [7, 8, 9]
        ];
        
        let matrix = JSON.parse(JSON.stringify(originalMatrix));
        const n = matrix.length;
        
        // Phase 1: Transpose swaps, Phase 2: Row reverses
        let phase = 1;
        let transposeI = 0;
        let transposeJ = 1;
        let reverseRow = 0;
        let autoRunning = false;
        let autoTimer = null;

        const width = 800;
        const height = 400;
        const svg = d3.select("#mainSvg")
            .attr("width", width)
            .attr("height", height);

        const cellSize = 60;

        function draw(highlight1 = null, highlight2 = null) {
            svg.selectAll("*").remove();

            // Original matrix (left)
            svg.append("text")
                .attr("x", 150)
                .attr("y", 30)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .text("Original");

            drawMatrix(originalMatrix, 70, 50, null, null, true);

            // Arrow
            svg.append("text")
                .attr("x", width / 2)
                .attr("y", height / 2)
                .attr("text-anchor", "middle")
                .attr("font-size", "30px")
                .text("‚Üí");

            // Current matrix (right)
            svg.append("text")
                .attr("x", width - 150)
                .attr("y", 30)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .text(phase === 1 ? "Transposing..." : "Reversing Rows...");

            drawMatrix(matrix, width - 70 - n * cellSize, 50, highlight1, highlight2, false);

            // Phase indicator
            svg.append("rect")
                .attr("x", width / 2 - 120)
                .attr("y", height - 70)
                .attr("width", 240)
                .attr("height", 50)
                .attr("rx", 8)
                .attr("fill", phase === 1 ? "#e3f2fd" : "#fff3e0")
                .attr("stroke", phase === 1 ? "#1976d2" : "#f57c00")
                .attr("stroke-width", 2);

            svg.append("text")
                .attr("x", width / 2)
                .attr("y", height - 40)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .text(phase === 1 ? "Phase 1: Transpose" : "Phase 2: Reverse Rows");
        }

        function drawMatrix(mat, x, y, hl1, hl2, isOriginal) {
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n; j++) {
                    const isHighlighted = (hl1 && hl1[0] === i && hl1[1] === j) ||
                                         (hl2 && hl2[0] === i && hl2[1] === j);
                    
                    const cellX = x + j * cellSize;
                    const cellY = y + i * cellSize;

                    svg.append("rect")
                        .attr("x", cellX)
                        .attr("y", cellY)
                        .attr("width", cellSize - 4)
                        .attr("height", cellSize - 4)
                        .attr("rx", 5)
                        .attr("fill", isHighlighted ? "#ffeb3b" : 
                                     isOriginal ? "#f5f5f5" : "#e8f5e9")
                        .attr("stroke", isHighlighted ? "#f57c00" : 
                                       isOriginal ? "#bdbdbd" : "#4caf50")
                        .attr("stroke-width", isHighlighted ? 3 : 2);

                    svg.append("text")
                        .attr("x", cellX + (cellSize - 4) / 2)
                        .attr("y", cellY + (cellSize - 4) / 2 + 5)
                        .attr("text-anchor", "middle")
                        .attr("font-size", "20px")
                        .attr("font-weight", "bold")
                        .text(mat[i][j]);
                }
            }

            // Row/col labels
            for (let i = 0; i < n; i++) {
                svg.append("text")
                    .attr("x", x - 15)
                    .attr("y", y + i * cellSize + (cellSize - 4) / 2 + 5)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "12px")
                    .attr("fill", "#666")
                    .text(i);

                svg.append("text")
                    .attr("x", x + i * cellSize + (cellSize - 4) / 2)
                    .attr("y", y - 8)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "12px")
                    .attr("fill", "#666")
                    .text(i);
            }
        }

        function step() {
            if (phase === 1) {
                // Transpose phase
                if (transposeI >= n) {
                    phase = 2;
                    document.getElementById("phaseDisplay").textContent = "2. Reverse Rows";
                    draw();
                    document.getElementById("status").textContent = "Transpose complete. Now reversing each row...";
                    return true;
                }

                if (transposeJ >= n) {
                    transposeI++;
                    transposeJ = transposeI + 1;
                    if (transposeI >= n - 1) {
                        phase = 2;
                        document.getElementById("phaseDisplay").textContent = "2. Reverse Rows";
                        draw();
                        document.getElementById("status").textContent = "Transpose complete. Now reversing each row...";
                        return true;
                    }
                    return step();
                }

                // Swap matrix[i][j] with matrix[j][i]
                const temp = matrix[transposeI][transposeJ];
                matrix[transposeI][transposeJ] = matrix[transposeJ][transposeI];
                matrix[transposeJ][transposeI] = temp;

                document.getElementById("opDisplay").textContent = 
                    `Swap [${transposeI}][${transposeJ}] ‚Üî [${transposeJ}][${transposeI}]`;
                
                draw([transposeI, transposeJ], [transposeJ, transposeI]);
                
                document.getElementById("status").textContent = 
                    `Transposing: swapped (${transposeI},${transposeJ}) with (${transposeJ},${transposeI})`;

                transposeJ++;
                return true;

            } else {
                // Reverse rows phase
                if (reverseRow >= n) {
                    document.getElementById("status").textContent = 
                        "Complete! Matrix rotated 90¬∞ clockwise";
                    document.getElementById("opDisplay").textContent = "Done!";
                    draw();
                    return false;
                }

                matrix[reverseRow].reverse();
                
                document.getElementById("opDisplay").textContent = 
                    `Reverse row ${reverseRow}`;
                
                draw();
                
                document.getElementById("status").textContent = 
                    `Reversed row ${reverseRow}: [${matrix[reverseRow].join(", ")}]`;

                reverseRow++;
                return reverseRow < n;
            }
        }

        function reset() {
            matrix = JSON.parse(JSON.stringify(originalMatrix));
            phase = 1;
            transposeI = 0;
            transposeJ = 1;
            reverseRow = 0;
            autoRunning = false;
            if (autoTimer) clearInterval(autoTimer);
            
            document.getElementById("phaseDisplay").textContent = "1. Transpose";
            document.getElementById("opDisplay").textContent = "-";
            document.getElementById("status").textContent = 'Click "Step" to rotate the matrix 90¬∞ clockwise';
            document.getElementById("autoBtn").textContent = "Auto Run";
            
            draw();
        }

        function autoRun() {
            if (autoRunning) {
                autoRunning = false;
                clearInterval(autoTimer);
                document.getElementById("autoBtn").textContent = "Auto Run";
            } else {
                autoRunning = true;
                document.getElementById("autoBtn").textContent = "Pause";
                const speed = 2100 - document.getElementById("speed").value;
                autoTimer = setInterval(() => {
                    if (!step()) {
                        autoRunning = false;
                        clearInterval(autoTimer);
                        document.getElementById("autoBtn").textContent = "Auto Run";
                    }
                }, speed);
            }
        }

        document.getElementById("stepBtn").addEventListener("click", step);
        document.getElementById("autoBtn").addEventListener("click", autoRun);
        document.getElementById("resetBtn").addEventListener("click", reset);

        draw();
    </script>
</body>
</html>
