<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sum of Two Integers - LeetCode 371</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="problem-info">
            <h1><span class="problem-number">#0371</span> Sum of Two Integers</h1>
            <p><strong>Problem:</strong> Given two integers a and b, return the sum of the two integers without using the operators + and -.</p>
            <p><strong>Pattern:</strong> Bit Manipulation - XOR for sum without carry, AND + shift for carry</p>
            <div class="problem-meta">
                <span class="meta-tag">üìä Array</span>
                <span class="meta-tag">‚è±Ô∏è O(n)</span>
            </div>
            <div class="file-ref">
                üìÑ Python: <code>python/0371_sum_of_two_integers/0371_sum_of_two_integers.py</code>
            </div>

        </div>

        <div class="explanation-panel">
            <h4>üß† How It Works (Layman's Terms)</h4>
            <p>This algorithm solves the problem <strong>step by step</strong>:</p>
            <ul>
                <li><strong>Understand:</strong> Parse the input data</li>
                <li><strong>Process:</strong> Apply the core logic</li>
                <li><strong>Optimize:</strong> Use efficient data structures</li>
                <li><strong>Return:</strong> Output the computed result</li>
            </ul>
        </div>


        <div class="visualization-section">
            <h3>üé¨ Step-by-Step Visualization</h3>

            <div class="visualization">
            <svg id="mainSvg"></svg>
        </div>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
            <div class="speed-control">
                <label for="speed">Speed:</label>
                <input type="range" id="speed" min="100" max="2000" value="800">
            </div>
        </div>

        <div class="status" id="status">Click "Step" to add numbers using bit manipulation</div>

        <div class="variables">
            <div class="var-item">
                <span class="var-label">a (sum without carry):</span>
                <span id="aDisplay">5</span>
            </div>
            <div class="var-item">
                <span class="var-label">b (carry):</span>
                <span id="bDisplay">3</span>
            </div>
            <div class="var-item">
                <span class="var-label">Iteration:</span>
                <span id="iterDisplay">0</span>
            </div>
        </div>

        </div>

        <div class="code-section">
            <h3>Python Solution</h3>
            <pre><span class="keyword">def</span> <span class="function">getSum</span>(a, b):
    <span class="string">"""
    Add without + or - operators.
    XOR = sum without carry
    AND << 1 = carry
    Repeat until no carry.
    Time: O(1) - max 32 iterations
    """</span>
    mask = <span class="number">0</span>xFFFFFFFF
    <span class="keyword">while</span> b != <span class="number">0</span>:
        temp = (a ^ b) & mask      <span class="comment"># Sum without carry</span>
        b = ((a & b) << <span class="number">1</span>) & mask  <span class="comment"># Carry</span>
        a = temp
    <span class="comment"># Handle negative numbers</span>
    <span class="keyword">return</span> a <span class="keyword">if</span> a <= <span class="number">0</span>x7FFFFFFF <span class="keyword">else</span> ~(a ^ mask)</pre>
        </div>
    </div>

    <script>
        const BITS = 8;
        const originalA = 5;
        const originalB = 3;
        let a = originalA;
        let b = originalB;
        let iteration = 0;
        let autoRunning = false;
        let autoTimer = null;

        const width = 850;
        const height = 450;
        const svg = d3.select("#mainSvg")
            .attr("width", width)
            .attr("height", height);

        function toBinary(num, bits = BITS) {
            if (num < 0) num = (1 << bits) + num;
            return (num >>> 0).toString(2).padStart(bits, '0');
        }

        function draw() {
            svg.selectAll("*").remove();

            svg.append("text")
                .attr("x", width / 2)
                .attr("y", 25)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .text(`Adding ${originalA} + ${originalB} without + operator`);

            const startY = 60;
            const colWidth = 35;
            const rowHeight = 40;

            // Current state
            drawSection("Current a (XOR result)", toBinary(a), a, 80, startY, "#e3f2fd", "#1976d2");
            drawSection("Current b (Carry)", toBinary(b), b, 80, startY + 60, "#fff3e0", "#f57c00");

            if (b !== 0) {
                // Show XOR operation
                const xorY = startY + 140;
                svg.append("text")
                    .attr("x", 50)
                    .attr("y", xorY)
                    .attr("font-weight", "bold")
                    .attr("fill", "#1976d2")
                    .text("XOR (sum without carry):");

                drawBits(toBinary(a), 280, xorY - 20, "#e3f2fd", "#1976d2");
                svg.append("text").attr("x", 240).attr("y", xorY).text("a:");
                
                drawBits(toBinary(b), 280, xorY + 20, "#fff3e0", "#f57c00");
                svg.append("text").attr("x", 230).attr("y", xorY + 40).text("‚äï b:");
                
                svg.append("line")
                    .attr("x1", 280).attr("y1", xorY + 45)
                    .attr("x2", 280 + BITS * colWidth).attr("y2", xorY + 45)
                    .attr("stroke", "#333").attr("stroke-width", 2);
                
                const xorResult = a ^ b;
                drawBits(toBinary(xorResult), 280, xorY + 60, "#c8e6c9", "#4caf50");
                svg.append("text")
                    .attr("x", 280 + BITS * colWidth + 10)
                    .attr("y", xorY + 80)
                    .attr("fill", "#4caf50")
                    .text(`= ${xorResult}`);

                // Show AND + shift operation
                const andY = startY + 280;
                svg.append("text")
                    .attr("x", 50)
                    .attr("y", andY)
                    .attr("font-weight", "bold")
                    .attr("fill", "#f57c00")
                    .text("AND << 1 (carry):");

                drawBits(toBinary(a), 280, andY - 20, "#e3f2fd", "#1976d2");
                svg.append("text").attr("x", 240).attr("y", andY).text("a:");
                
                drawBits(toBinary(b), 280, andY + 20, "#fff3e0", "#f57c00");
                svg.append("text").attr("x", 230).attr("y", andY + 40).text("& b:");
                
                svg.append("line")
                    .attr("x1", 280).attr("y1", andY + 45)
                    .attr("x2", 280 + BITS * colWidth).attr("y2", andY + 45)
                    .attr("stroke", "#333").attr("stroke-width", 2);
                
                const andResult = a & b;
                const carry = andResult << 1;
                drawBits(toBinary(andResult), 280, andY + 60, "#e0e0e0", "#666");
                svg.append("text")
                    .attr("x", 280 + BITS * colWidth + 10)
                    .attr("y", andY + 80)
                    .attr("fill", "#666")
                    .text(`= ${andResult}`);

                svg.append("text")
                    .attr("x", 280 + BITS * colWidth + 80)
                    .attr("y", andY + 80)
                    .attr("fill", "#f57c00")
                    .text(`<< 1 = ${carry}`);
            }

            // Result
            if (b === 0) {
                svg.append("rect")
                    .attr("x", width / 2 - 100)
                    .attr("y", height - 80)
                    .attr("width", 200)
                    .attr("height", 50)
                    .attr("rx", 8)
                    .attr("fill", "#c8e6c9")
                    .attr("stroke", "#4caf50")
                    .attr("stroke-width", 2);

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", height - 50)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "20px")
                    .attr("font-weight", "bold")
                    .text(`Result: ${a}`);
            }
        }

        function drawSection(label, binary, value, x, y, fill, stroke) {
            svg.append("text")
                .attr("x", x)
                .attr("y", y)
                .attr("font-size", "14px")
                .attr("fill", "#666")
                .text(label);

            drawBits(binary, x + 200, y - 15, fill, stroke);
            
            svg.append("text")
                .attr("x", x + 200 + BITS * 35 + 10)
                .attr("y", y)
                .attr("font-weight", "bold")
                .text(`= ${value}`);
        }

        function drawBits(bits, x, y, fill, stroke) {
            bits.split('').forEach((bit, i) => {
                svg.append("rect")
                    .attr("x", x + i * 35)
                    .attr("y", y)
                    .attr("width", 30)
                    .attr("height", 30)
                    .attr("rx", 4)
                    .attr("fill", bit === '1' ? fill : "#f5f5f5")
                    .attr("stroke", bit === '1' ? stroke : "#bdbdbd")
                    .attr("stroke-width", 2);

                svg.append("text")
                    .attr("x", x + i * 35 + 15)
                    .attr("y", y + 20)
                    .attr("text-anchor", "middle")
                    .attr("font-family", "monospace")
                    .attr("font-weight", "bold")
                    .attr("fill", bit === '1' ? stroke : "#999")
                    .text(bit);
            });
        }

        function step() {
            if (b === 0) return false;

            const temp = a ^ b;
            b = (a & b) << 1;
            a = temp;
            iteration++;

            document.getElementById("aDisplay").textContent = `${a} (${toBinary(a)})`;
            document.getElementById("bDisplay").textContent = `${b} (${toBinary(b)})`;
            document.getElementById("iterDisplay").textContent = iteration;

            draw();

            if (b === 0) {
                document.getElementById("status").textContent = 
                    `Complete! ${originalA} + ${originalB} = ${a}`;
                return false;
            } else {
                document.getElementById("status").textContent = 
                    `Iteration ${iteration}: a = ${a}, carry b = ${b}`;
                return true;
            }
        }

        function reset() {
            a = originalA;
            b = originalB;
            iteration = 0;
            autoRunning = false;
            if (autoTimer) clearInterval(autoTimer);
            
            document.getElementById("aDisplay").textContent = `${a}`;
            document.getElementById("bDisplay").textContent = `${b}`;
            document.getElementById("iterDisplay").textContent = "0";
            document.getElementById("status").textContent = 'Click "Step" to add numbers using bit manipulation';
            document.getElementById("autoBtn").textContent = "Auto Run";
            
            draw();
        }

        function autoRun() {
            if (autoRunning) {
                autoRunning = false;
                clearInterval(autoTimer);
                document.getElementById("autoBtn").textContent = "Auto Run";
            } else {
                autoRunning = true;
                document.getElementById("autoBtn").textContent = "Pause";
                const speed = 2100 - document.getElementById("speed").value;
                autoTimer = setInterval(() => {
                    if (!step()) {
                        autoRunning = false;
                        clearInterval(autoTimer);
                        document.getElementById("autoBtn").textContent = "Auto Run";
                    }
                }, speed);
            }
        }

        document.getElementById("stepBtn").addEventListener("click", step);
        document.getElementById("autoBtn").addEventListener("click", autoRun);
        document.getElementById("resetBtn").addEventListener("click", reset);

        draw();
    </script>
</body>
</html>
