<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Two Numbers - Algorithm Visualization</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    </div>

    <div class="container">
        <div class="problem-info">
            <h1><span class="problem-number">#0002</span> Add Two Numbers</h1>
            <p>
                You are given two non-empty linked lists representing two non-negative integers.
                The digits are stored in <strong>reverse order</strong>, and each node contains a single digit.
                Add the two numbers and return the sum as a linked list.
            </p>
            <p><strong>Example:</strong> l1 = [2,4,3], l2 = [5,6,4] ‚Üí Output: [7,0,8] (342 + 465 = 807)</p>
            <p><strong>Time Complexity:</strong> O(max(n, m)) where n and m are lengths of the lists</p>
            <p><strong>Space Complexity:</strong> O(max(n, m)) for the result list</p>
            <div class="problem-meta">
                <span class="meta-tag">üîó Linked List</span>
                <span class="meta-tag">‚è±Ô∏è O(n)</span>
            </div>
            <div class="file-ref">
                üìÑ Python: <code>python/0002_add_two_numbers/0002_add_two_numbers.py</code>
            </div>

        </div>

        <div class="explanation-panel">
            <h4>üß† How It Works (Layman's Terms)</h4>
            <p>This algorithm solves the problem <strong>step by step</strong>:</p>
            <ul>
                <li><strong>Understand:</strong> Parse the input data</li>
                <li><strong>Process:</strong> Apply the core logic</li>
                <li><strong>Optimize:</strong> Use efficient data structures</li>
                <li><strong>Return:</strong> Output the computed result</li>
            </ul>
        </div>


        <div class="visualization-section">
            <h3>üé¨ Step-by-Step Visualization</h3>
            <div class="controls">
                <button id="stepBtn" class="btn">Step</button>
                <button id="autoBtn" class="btn">Auto Run</button>
                <button id="resetBtn" class="btn btn-secondary">Reset</button>
                <div class="speed-control">
                    <label for="speedSlider">Speed:</label>
                    <input type="range" id="speedSlider" min="1" max="10" value="5">
                </div>
            </div>
            <svg id="visualization" width="900" height="500"></svg>
            <div class="variables-display">
                <div id="varDisplay"></div>
            </div>
            <div class="status-message" id="statusMessage">Press "Step" or "Auto Run" to begin</div>
        </div>

        <div class="code-section">
            <h3>üíª Python Solution</h3>
            <div class="code-block">
                <pre><span class="keyword">def</span> <span class="function">add_two_numbers</span>(self, l1: <span class="class-name">ListNode</span>, l2: <span class="class-name">ListNode</span>) -> ListNode:
    dummy = <span class="function">ListNode</span>(<span class="number">0</span>)
    current = dummy
    carry = <span class="number">0</span>
    
    <span class="keyword">while</span> l1 <span class="keyword">or</span> l2 <span class="keyword">or</span> carry:
        x = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span>
        y = l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span>
        
        total = carry + x + y
        carry = total // <span class="number">10</span>
        
        current.next = <span class="function">ListNode</span>(total % <span class="number">10</span>)
        current = current.next
        
        <span class="keyword">if</span> l1: <span class="class-name">l1</span> = l1.next
        <span class="keyword">if</span> l2: <span class="class-name">l2</span> = l2.next
    
    <span class="keyword">return</span> dummy.next</pre>
            </div>
        </div>
    </div>

    <script>
        // Data
        const l1Values = [2, 4, 3];  // Represents 342
        const l2Values = [5, 6, 4];  // Represents 465
        
        // State
        let l1Index = 0;
        let l2Index = 0;
        let carry = 0;
        let result = [];
        let step = 0;
        let autoRunning = false;
        let autoInterval = null;
        
        // Steps
        const steps = [];
        
        // Generate steps
        function generateSteps() {
            steps.length = 0;
            let tempL1 = 0, tempL2 = 0, tempCarry = 0;
            const tempResult = [];
            
            steps.push({
                type: 'init',
                l1Index: -1,
                l2Index: -1,
                carry: 0,
                result: [],
                message: 'Initialize: dummy node and carry = 0'
            });
            
            while (tempL1 < l1Values.length || tempL2 < l2Values.length || tempCarry > 0) {
                const x = tempL1 < l1Values.length ? l1Values[tempL1] : 0;
                const y = tempL2 < l2Values.length ? l2Values[tempL2] : 0;
                
                steps.push({
                    type: 'get_values',
                    l1Index: tempL1,
                    l2Index: tempL2,
                    x: x,
                    y: y,
                    carry: tempCarry,
                    result: [...tempResult],
                    message: `Get values: x = ${x}, y = ${y}, carry = ${tempCarry}`
                });
                
                const total = tempCarry + x + y;
                const newCarry = Math.floor(total / 10);
                const digit = total % 10;
                
                steps.push({
                    type: 'calculate',
                    l1Index: tempL1,
                    l2Index: tempL2,
                    total: total,
                    newCarry: newCarry,
                    digit: digit,
                    carry: tempCarry,
                    result: [...tempResult],
                    message: `Calculate: ${tempCarry} + ${x} + ${y} = ${total} ‚Üí digit = ${digit}, carry = ${newCarry}`
                });
                
                tempResult.push(digit);
                tempCarry = newCarry;
                
                steps.push({
                    type: 'add_node',
                    l1Index: tempL1,
                    l2Index: tempL2,
                    carry: tempCarry,
                    result: [...tempResult],
                    message: `Add node with value ${digit} to result. Move to next nodes.`
                });
                
                if (tempL1 < l1Values.length) tempL1++;
                if (tempL2 < l2Values.length) tempL2++;
            }
            
            steps.push({
                type: 'done',
                l1Index: tempL1,
                l2Index: tempL2,
                carry: 0,
                result: [...tempResult],
                message: `Done! Result: [${tempResult.join(', ')}] represents ${parseInt(tempResult.slice().reverse().join(''))}`
            });
        }
        
        // SVG setup
        const svg = d3.select("#visualization");
        const width = 900;
        const height = 500;
        
        function draw(currentStep) {
            svg.selectAll("*").remove();
            
            const data = currentStep || steps[0];
            
            // Draw L1
            svg.append("text")
                .attr("x", 50)
                .attr("y", 80)
                .attr("class", "label")
                .text(`L1 (${l1Values.slice().reverse().join('')}):`);
            
            l1Values.forEach((val, i) => {
                const group = svg.append("g")
                    .attr("transform", `translate(${150 + i * 80}, 60)`);
                
                const isActive = data.l1Index === i && data.type === 'get_values';
                
                group.append("rect")
                    .attr("width", 50)
                    .attr("height", 40)
                    .attr("rx", 8)
                    .attr("fill", isActive ? "#4ade80" : (i < (data.l1Index !== undefined ? data.l1Index + 1 : 0) ? "#9ca3af" : "#667eea"))
                    .attr("stroke", isActive ? "#16a34a" : "none")
                    .attr("stroke-width", 3);
                
                group.append("text")
                    .attr("x", 25)
                    .attr("y", 27)
                    .attr("text-anchor", "middle")
                    .attr("fill", "white")
                    .attr("font-weight", "bold")
                    .attr("font-size", "18px")
                    .text(val);
                
                if (i < l1Values.length - 1) {
                    group.append("line")
                        .attr("x1", 50)
                        .attr("y1", 20)
                        .attr("x2", 70)
                        .attr("y2", 20)
                        .attr("stroke", "#667eea")
                        .attr("stroke-width", 2)
                        .attr("marker-end", "url(#arrow)");
                }
            });
            
            // Draw L2
            svg.append("text")
                .attr("x", 50)
                .attr("y", 160)
                .attr("class", "label")
                .text(`L2 (${l2Values.slice().reverse().join('')}):`);
            
            l2Values.forEach((val, i) => {
                const group = svg.append("g")
                    .attr("transform", `translate(${150 + i * 80}, 140)`);
                
                const isActive = data.l2Index === i && data.type === 'get_values';
                
                group.append("rect")
                    .attr("width", 50)
                    .attr("height", 40)
                    .attr("rx", 8)
                    .attr("fill", isActive ? "#4ade80" : (i < (data.l2Index !== undefined ? data.l2Index + 1 : 0) ? "#9ca3af" : "#764ba2"))
                    .attr("stroke", isActive ? "#16a34a" : "none")
                    .attr("stroke-width", 3);
                
                group.append("text")
                    .attr("x", 25)
                    .attr("y", 27)
                    .attr("text-anchor", "middle")
                    .attr("fill", "white")
                    .attr("font-weight", "bold")
                    .attr("font-size", "18px")
                    .text(val);
                
                if (i < l2Values.length - 1) {
                    group.append("line")
                        .attr("x1", 50)
                        .attr("y1", 20)
                        .attr("x2", 70)
                        .attr("y2", 20)
                        .attr("stroke", "#764ba2")
                        .attr("stroke-width", 2);
                }
            });
            
            // Draw arrow marker
            svg.append("defs").append("marker")
                .attr("id", "arrow")
                .attr("viewBox", "0 0 10 10")
                .attr("refX", 5)
                .attr("refY", 5)
                .attr("markerWidth", 6)
                .attr("markerHeight", 6)
                .attr("orient", "auto")
                .append("path")
                .attr("d", "M 0 0 L 10 5 L 0 10 z")
                .attr("fill", "#667eea");
            
            // Draw calculation box
            if (data.type === 'get_values' || data.type === 'calculate') {
                const calcGroup = svg.append("g")
                    .attr("transform", "translate(450, 230)");
                
                calcGroup.append("rect")
                    .attr("width", 200)
                    .attr("height", 100)
                    .attr("rx", 10)
                    .attr("fill", "#f0fdf4")
                    .attr("stroke", "#4ade80")
                    .attr("stroke-width", 2);
                
                calcGroup.append("text")
                    .attr("x", 100)
                    .attr("y", 30)
                    .attr("text-anchor", "middle")
                    .attr("font-weight", "bold")
                    .text("Calculation");
                
                if (data.type === 'calculate') {
                    calcGroup.append("text")
                        .attr("x", 100)
                        .attr("y", 55)
                        .attr("text-anchor", "middle")
                        .text(`${data.carry} + ${data.x || 0} + ${data.y || 0} = ${data.total}`);
                    
                    calcGroup.append("text")
                        .attr("x", 100)
                        .attr("y", 80)
                        .attr("text-anchor", "middle")
                        .attr("fill", "#059669")
                        .text(`digit: ${data.digit}, carry: ${data.newCarry}`);
                }
            }
            
            // Draw carry
            svg.append("text")
                .attr("x", 50)
                .attr("y", 280)
                .attr("class", "label")
                .text("Carry:");
            
            const carryBox = svg.append("g")
                .attr("transform", "translate(120, 255)");
            
            carryBox.append("rect")
                .attr("width", 50)
                .attr("height", 40)
                .attr("rx", 8)
                .attr("fill", data.carry > 0 ? "#f59e0b" : "#e5e7eb");
            
            carryBox.append("text")
                .attr("x", 25)
                .attr("y", 27)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .attr("font-size", "18px")
                .text(data.carry || 0);
            
            // Draw result
            svg.append("text")
                .attr("x", 50)
                .attr("y", 380)
                .attr("class", "label")
                .text("Result:");
            
            if (data.result && data.result.length > 0) {
                data.result.forEach((val, i) => {
                    const group = svg.append("g")
                        .attr("transform", `translate(${150 + i * 80}, 355)`);
                    
                    const isNew = i === data.result.length - 1 && data.type === 'add_node';
                    
                    group.append("rect")
                        .attr("width", 50)
                        .attr("height", 40)
                        .attr("rx", 8)
                        .attr("fill", isNew ? "#4ade80" : "#06b6d4")
                        .attr("stroke", isNew ? "#16a34a" : "none")
                        .attr("stroke-width", isNew ? 3 : 0);
                    
                    group.append("text")
                        .attr("x", 25)
                        .attr("y", 27)
                        .attr("text-anchor", "middle")
                        .attr("fill", "white")
                        .attr("font-weight", "bold")
                        .attr("font-size", "18px")
                        .text(val);
                    
                    if (i < data.result.length - 1) {
                        group.append("line")
                            .attr("x1", 50)
                            .attr("y1", 20)
                            .attr("x2", 70)
                            .attr("y2", 20)
                            .attr("stroke", "#06b6d4")
                            .attr("stroke-width", 2);
                    }
                });
                
                // Show decimal representation
                if (data.result.length > 0) {
                    const decimal = parseInt(data.result.slice().reverse().join('')) || 0;
                    svg.append("text")
                        .attr("x", 150 + data.result.length * 80 + 30)
                        .attr("y", 380)
                        .attr("fill", "#6b7280")
                        .text(`= ${decimal}`);
                }
            }
            
            // Show equations
            svg.append("text")
                .attr("x", 50)
                .attr("y", 450)
                .attr("fill", "#4b5563")
                .attr("font-size", "16px")
                .text(`${l1Values.slice().reverse().join('')} + ${l2Values.slice().reverse().join('')} = ${parseInt(l1Values.slice().reverse().join('')) + parseInt(l2Values.slice().reverse().join(''))}`);
            
            // Update status
            document.getElementById("statusMessage").textContent = data.message;
            
            // Update variables
            document.getElementById("varDisplay").innerHTML = `
                <span class="var-item">L1 Index: ${data.l1Index >= 0 ? data.l1Index : 'N/A'}</span>
                <span class="var-item">L2 Index: ${data.l2Index >= 0 ? data.l2Index : 'N/A'}</span>
                <span class="var-item">Carry: ${data.carry || 0}</span>
                <span class="var-item">Result: [${data.result ? data.result.join(', ') : ''}]</span>
            `;
        }
        
        function doStep() {
            if (step >= steps.length) {
                stopAuto();
                return;
            }
            draw(steps[step]);
            step++;
        }
        
        function stopAuto() {
            autoRunning = false;
            if (autoInterval) {
                clearInterval(autoInterval);
                autoInterval = null;
            }
            document.getElementById("autoBtn").textContent = "Auto Run";
        }
        
        function toggleAuto() {
            if (autoRunning) {
                stopAuto();
            } else {
                autoRunning = true;
                document.getElementById("autoBtn").textContent = "Pause";
                const speed = 11 - document.getElementById("speedSlider").value;
                autoInterval = setInterval(() => {
                    if (step >= steps.length) {
                        stopAuto();
                        return;
                    }
                    doStep();
                }, speed * 200);
            }
        }
        
        function reset() {
            stopAuto();
            step = 0;
            draw(steps[0]);
        }
        
        // Initialize
        generateSteps();
        draw(steps[0]);
        
        // Event listeners
        document.getElementById("stepBtn").addEventListener("click", doStep);
        document.getElementById("autoBtn").addEventListener("click", toggleAuto);
        document.getElementById("resetBtn").addEventListener("click", reset);
    </script>
</body>
</html>
