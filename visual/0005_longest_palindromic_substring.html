<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Longest Palindromic Substring - LeetCode 5</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="problem-info">
            <h1><span class="problem-number">#0005</span> Longest Palindromic Substring</h1>
            <p><strong>Problem:</strong> Find the longest palindromic substring in a given string.</p>
            <p><strong>Pattern:</strong> Expand Around Center - For each position, expand outward while characters match</p>
            <div class="problem-meta">
                <span class="meta-tag">üå≥ Tree</span>
                <span class="meta-tag">üî§ String</span>
                <span class="meta-tag">üßÆ DP</span>
                <span class="meta-tag">‚è±Ô∏è O(n)</span>
            </div>
            <div class="file-ref">
                üìÑ Python: <code>python/0005_longest_palindromic_substring/0005_longest_palindromic_substring.py</code>
            </div>

        </div>

        <div class="explanation-panel">
            <h4>üß† How It Works (Layman's Terms)</h4>
            <p>Tree traversal is like <strong>exploring a family tree</strong>:</p>
            <ul>
                <li><strong>Root:</strong> Start at the top node</li>
                <li><strong>Recurse:</strong> Visit left and right children</li>
                <li><strong>Base case:</strong> Stop at null/leaf nodes</li>
                <li><strong>Combine:</strong> Build answer from subtree results</li>
            </ul>
        </div>


        <div class="visualization-section">
            <h3>üé¨ Step-by-Step Visualization</h3>

            <div class="visualization">
            <svg id="mainSvg"></svg>
        </div>

        <div class="controls">
            <button id="stepBtn">Step</button>
            <button id="autoBtn">Auto Run</button>
            <button id="resetBtn">Reset</button>
            <div class="speed-control">
                <label for="speed">Speed:</label>
                <input type="range" id="speed" min="100" max="2000" value="800">
            </div>
        </div>

        <div class="status" id="status">Click "Step" to find longest palindrome</div>

        <div class="variables">
            <div class="var-item">
                <span class="var-label">Center:</span>
                <span id="centerDisplay">-</span>
            </div>
            <div class="var-item">
                <span class="var-label">Current Palindrome:</span>
                <span id="currentDisplay">-</span>
            </div>
            <div class="var-item">
                <span class="var-label">Longest:</span>
                <span id="longestDisplay">-</span>
            </div>
        </div>

        </div>

        <div class="code-section">
            <h3>Python Solution</h3>
            <pre><span class="keyword">def</span> <span class="function">longestPalindrome</span>(s):
    <span class="string">"""
    Expand around each center.
    Time: O(n¬≤), Space: O(1)
    """</span>
    <span class="keyword">def</span> <span class="function">expand</span>(l, r):
        <span class="keyword">while</span> l >= <span class="number">0</span> <span class="keyword">and</span> r < <span class="function">len</span>(s) <span class="keyword">and</span> s[l] == s[r]:
            l -= <span class="number">1</span>
            r += <span class="number">1</span>
        <span class="keyword">return</span> s[l+<span class="number">1</span>:<span class="class-name">r</span>]
    
    result = <span class="string">""</span>
    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="function">len</span>(s)):
        <span class="comment"># Odd length palindrome</span>
        odd = <span class="function">expand</span>(i, i)
        <span class="comment"># Even length palindrome</span>
        even = <span class="function">expand</span>(i, i + <span class="number">1</span>)
        
        <span class="keyword">if</span> <span class="function">len</span>(odd) > <span class="function">len</span>(result):
            result = odd
        <span class="keyword">if</span> <span class="function">len</span>(even) > <span class="function">len</span>(result):
            result = even
    
    <span class="keyword">return</span> result</pre>
        </div>
    </div>

    <script>
        const s = "babad";
        
        let centerIdx = 0;
        let isEven = false;
        let left = 0, right = 0;
        let expandPhase = 'start';
        let longest = "";
        let longestStart = -1, longestEnd = -1;
        let currentStart = -1, currentEnd = -1;
        let autoRunning = false;
        let autoTimer = null;

        const width = 750;
        const height = 350;
        const svg = d3.select("#mainSvg")
            .attr("width", width)
            .attr("height", height);

        const charWidth = 60;
        const startX = (width - s.length * charWidth) / 2;

        function draw() {
            svg.selectAll("*").remove();

            svg.append("text")
                .attr("x", width / 2).attr("y", 30)
                .attr("text-anchor", "middle")
                .attr("font-weight", "bold")
                .text(`Finding Longest Palindromic Substring in "${s}"`);

            // Draw string
            for (let i = 0; i < s.length; i++) {
                const x = startX + i * charWidth + charWidth / 2;
                const y = 120;

                // Background
                let fill = "#e3f2fd", stroke = "#1976d2";
                
                if (i >= longestStart && i <= longestEnd) {
                    fill = "#c8e6c9"; stroke = "#4caf50";
                }
                if (i >= currentStart && i <= currentEnd && expandPhase !== 'done') {
                    fill = "#fff3e0"; stroke = "#ff9800";
                }
                if (i === left || i === right) {
                    fill = "#ffeb3b"; stroke = "#f57c00";
                }

                svg.append("rect")
                    .attr("x", x - 25).attr("y", y - 30)
                    .attr("width", 50).attr("height", 50)
                    .attr("rx", 8)
                    .attr("fill", fill).attr("stroke", stroke)
                    .attr("stroke-width", 2);

                svg.append("text")
                    .attr("x", x).attr("y", y)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "28px")
                    .attr("font-weight", "bold")
                    .text(s[i]);

                // Index
                svg.append("text")
                    .attr("x", x).attr("y", y + 40)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "12px")
                    .attr("fill", "#666")
                    .text(i);
            }

            // Center indicator
            if (centerIdx < s.length) {
                const centerX = startX + centerIdx * charWidth + charWidth / 2;
                svg.append("text")
                    .attr("x", centerX + (isEven ? charWidth / 2 : 0))
                    .attr("y", 60)
                    .attr("text-anchor", "middle")
                    .attr("font-size", "14px")
                    .attr("fill", "#7b1fa2")
                    .text(isEven ? "‚ñº even center" : "‚ñº odd center");
            }

            // Left/Right pointers
            if (expandPhase !== 'done' && expandPhase !== 'start') {
                if (left >= 0 && left < s.length) {
                    svg.append("text")
                        .attr("x", startX + left * charWidth + charWidth / 2)
                        .attr("y", 185)
                        .attr("text-anchor", "middle")
                        .attr("font-size", "14px")
                        .attr("fill", "#f57c00")
                        .text("L");
                }
                if (right >= 0 && right < s.length) {
                    svg.append("text")
                        .attr("x", startX + right * charWidth + charWidth / 2)
                        .attr("y", 185)
                        .attr("text-anchor", "middle")
                        .attr("font-size", "14px")
                        .attr("fill", "#f57c00")
                        .text("R");
                }
            }

            // Current and longest palindrome display
            svg.append("text")
                .attr("x", 50).attr("y", 250)
                .attr("font-size", "14px")
                .text("Current: ");

            if (currentStart >= 0) {
                svg.append("text")
                    .attr("x", 120).attr("y", 250)
                    .attr("font-size", "16px")
                    .attr("font-weight", "bold")
                    .attr("fill", "#ff9800")
                    .text(`"${s.substring(currentStart, currentEnd + 1)}"`);
            }

            svg.append("text")
                .attr("x", 50).attr("y", 280)
                .attr("font-size", "14px")
                .text("Longest: ");

            if (longest) {
                svg.append("text")
                    .attr("x", 120).attr("y", 280)
                    .attr("font-size", "16px")
                    .attr("font-weight", "bold")
                    .attr("fill", "#4caf50")
                    .text(`"${longest}"`);
            }

            // Legend
            const legend = [
                {color: "#e3f2fd", label: "Unvisited"},
                {color: "#ffeb3b", label: "L/R pointers"},
                {color: "#fff3e0", label: "Current palindrome"},
                {color: "#c8e6c9", label: "Longest found"}
            ];

            legend.forEach((item, i) => {
                svg.append("rect")
                    .attr("x", 10 + i * 140).attr("y", height - 30)
                    .attr("width", 15).attr("height", 15)
                    .attr("fill", item.color)
                    .attr("stroke", "#999");
                svg.append("text")
                    .attr("x", 30 + i * 140).attr("y", height - 18)
                    .attr("font-size", "11px")
                    .text(item.label);
            });
        }

        function step() {
            if (centerIdx >= s.length && isEven) {
                document.getElementById("status").textContent = 
                    `Done! Longest palindrome: "${longest}"`;
                draw();
                return false;
            }

            if (expandPhase === 'start' || expandPhase === 'done') {
                // Start new expansion
                if (isEven) {
                    left = centerIdx;
                    right = centerIdx + 1;
                } else {
                    left = centerIdx;
                    right = centerIdx;
                }
                currentStart = left;
                currentEnd = right;
                expandPhase = 'expanding';

                document.getElementById("centerDisplay").textContent = 
                    `${centerIdx}${isEven ? ' (even)' : ' (odd)'}`;
                document.getElementById("status").textContent = 
                    `Starting ${isEven ? 'even' : 'odd'} expansion from center ${centerIdx}`;
            } else if (expandPhase === 'expanding') {
                // Check if we can expand
                if (left >= 0 && right < s.length && s[left] === s[right]) {
                    currentStart = left;
                    currentEnd = right;
                    document.getElementById("currentDisplay").textContent = 
                        `"${s.substring(left, right + 1)}"`;
                    document.getElementById("status").textContent = 
                        `s[${left}]='${s[left]}' == s[${right}]='${s[right]}' ‚úì Expanding...`;
                    left--;
                    right++;
                } else {
                    // Can't expand further
                    const current = s.substring(currentStart, currentEnd + 1);
                    if (current.length > longest.length) {
                        longest = current;
                        longestStart = currentStart;
                        longestEnd = currentEnd;
                        document.getElementById("longestDisplay").textContent = 
                            `"${longest}" (len=${longest.length})`;
                    }
                    
                    if (left < 0 || right >= s.length) {
                        document.getElementById("status").textContent = 
                            `Reached boundary. Palindrome: "${current}"`;
                    } else {
                        document.getElementById("status").textContent = 
                            `s[${left}]='${s[left]}' != s[${right}]='${s[right]}' ‚úó Stop.`;
                    }

                    expandPhase = 'done';
                    
                    // Move to next
                    if (isEven) {
                        centerIdx++;
                        isEven = false;
                    } else {
                        isEven = true;
                    }
                }
            }

            draw();
            return centerIdx < s.length || !isEven;
        }

        function reset() {
            centerIdx = 0;
            isEven = false;
            left = 0; right = 0;
            expandPhase = 'start';
            longest = "";
            longestStart = -1; longestEnd = -1;
            currentStart = -1; currentEnd = -1;
            autoRunning = false;
            if (autoTimer) clearInterval(autoTimer);
            
            document.getElementById("centerDisplay").textContent = "-";
            document.getElementById("currentDisplay").textContent = "-";
            document.getElementById("longestDisplay").textContent = "-";
            document.getElementById("status").textContent = 
                'Click "Step" to find longest palindrome';
            document.getElementById("autoBtn").textContent = "Auto Run";
            
            draw();
        }

        function autoRun() {
            if (autoRunning) {
                autoRunning = false;
                clearInterval(autoTimer);
                document.getElementById("autoBtn").textContent = "Auto Run";
            } else {
                autoRunning = true;
                document.getElementById("autoBtn").textContent = "Pause";
                const speed = 2100 - document.getElementById("speed").value;
                autoTimer = setInterval(() => {
                    if (!step()) {
                        autoRunning = false;
                        clearInterval(autoTimer);
                        document.getElementById("autoBtn").textContent = "Auto Run";
                    }
                }, speed);
            }
        }

        document.getElementById("stepBtn").addEventListener("click", step);
        document.getElementById("autoBtn").addEventListener("click", autoRun);
        document.getElementById("resetBtn").addEventListener("click", reset);

        draw();
    </script>
</body>
</html>
